!function(a,b){var c=a.urbanclap=a.urbanclap||{},d=a.uca,e={version:"2.4.0",config:{eventApi:{url:"https://event-api.urbanclap.com/newevent",headers:{"Content-Type":"application/json; charset=utf-8","x-api-token":"oa4hulm06qctaaligr1cq3ohhmo33c5j"},requestMethod:"POST"},log:!1,disabled:!1,dupeDiff:1e3,attributionValidDays:28,cities:["ahmedabad","bangalore","chennai","delhi-ncr","hyderabad","kolkata","mumbai","pune"]},store:{session:{},previous:{}},uuid:function(){var a,b=+new Date,c=Math.floor(999999*Math.random()+9999).toString(16);return"ucucucu".substr(0,8-c.length)+c+"-yxxxxxxxxx-yxxx-yxxx-yxxx-xxxxxxxxxx".replace(/[xy]/g,function(c){return a=((b=Math.floor(b/16))+16*Math.random())%16|0,("x"==c?a:3&a|8).toString(16)})+"-"+ +new Date},cookie:{get:function(a){for(var c=a+"=",d=b.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1);if(0==f.indexOf(c))return f.substring(c.length,f.length)}return null},set:function(a,c,d){var e=new Date;return e.setTime(e.getTime()+24*(d||36500)*60*60*1e3),b.cookie=a+"="+c+"; expires="+e.toUTCString()+"; path=/",c},del:function(a){var c=new Date;return c.setTime(c.getTime()-864e5),b.cookie=a+"=0; expires="+c.toUTCString()+"; path=/",!0}},session:{start:function(a,b){return b&&e.cookie.get("_uca_session_id")?e.store.session={id:e.cookie.get("_uca_session_id"),startTs:e.cookie.get("_uca_session_start_ts"),endTs:e.cookie.get("_uca_session_end_ts")}:e.store.session={id:e.cookie.set("_uca_session_id",a||e.uuid(),1/24),startTs:e.cookie.set("_uca_session_start_ts",e.getTime(),1/24),endTs:e.cookie.set("_uca_session_end_ts",e.getTime()+36e5,1/24)}},end:function(){return e.session.start(),!0},get:function(){return e.store.session}},getQueryParam:function(b){b=b.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)"),d=c.exec(a.location.href);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},browserInfo:{name:function(){var b,a=navigator.userAgent,c=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(b=/\brv[ :]+(\d+)/g.exec(a)||[],"IE "+(b[1]||"")):"Chrome"===c[1]&&null!=(b=a.match(/\b(OPR|Edge)\/(\d+)/))?b.slice(1).join(" ").replace("OPR","Opera"):(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(b=a.match(/version\/(\d+)/i))&&c.splice(1,1,b[1]),c)},type:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile-web":"desktop-web"}},serverSync:function(a){this.fireXhr("https://event-api.urbanclap.com/getconfig?ts="+ +new Date,{},"GET",{},function(b){if(200===b.status){var c=JSON.parse(b.response);e.store.serverSid=c.uuid,e.store.serverTs=c.server_time,e.store.serverTsDiff=+new Date-c.server_time,a()}else e.store.failedAttempts?e.store.failedAttempts++:e.store.failedAttempts=1,e.store.failedAttempts<3&&e.serverSync(a)})},getTime:function(){return+new Date-this.store.serverTsDiff},init:function(){return c.analytics?(this.log("Urbanclap Analytics already loaded."),!1):("object"==typeof d.config&&this.extend(this.config,d.config),this.store.uuid=this.cookie.get("_uca_uuid")||this.cookie.set("_uca_new_user","true",1)&&this.cookie.set("_uca_uuid",this.uuid()),this.session.start(this.store.serverSid,!0),this.defaultData={uuid:this.store.uuid,sessionId:this.store.session.id,version:this.version,url:a.location.href||null,referrer:b.referrer||null,referrerDomain:b.referrer?function(){var a=b.createElement("a");return a.href=b.referrer,a.hostname.replace(/^www\./i,"")}():null,userAgent:a.navigator?a.navigator.userAgent:null},"object"==typeof d.defaultData&&this.extend(this.defaultData,d.defaultData),this.store.queuedEvents=d.queue,this.utmAttribution(),this.fireSession(),{track:this.track.bind(this),startSession:this.session.start.bind(this),endSession:this.session.end.bind(this)})},fireQueuedEvents:function(){if("object"==typeof this.store.queuedEvents&&this.store.queuedEvents instanceof Array)for(var a=0,b=this.store.queuedEvents,c=b[a];a<b.length;c=b[++a])c.status||(this[c.name].apply(this,c.arguments),c.status=1)},eventData:function(){return{event_timestamp:this.getTime().toString(),client_timestamp:(+new Date).toString(),schema_type:"event",session:{session_id:this.session.get().id,start_timestamp:this.session.get().startTs.toString()},user:{user_type:this.config.userType||"",user_id:this.cookie.get("_uc_user_id")||""},context:{customer_id:this.cookie.get("_uc_user_id")||"",category_key:this.cookie.get("categoryKey")||"",city_key:this.cookie.get("currentCity")||""}}},isDuplicate:function(a){var b=this.store.previous.event;return!!(b&&b.event.name===a.event.name&&b.event.action===a.event.action&&+new Date-this.store.previous.ts<=this.config.dupeDiff)&&(this.config.log&&this.log("Duplicate event ignored - ",a.event.name,a),!0)},track:function(a){return this.isDuplicate(a)?(this.store.previous={event:a,ts:+new Date},!1):(this.store.previous={event:a,ts:+new Date},this.config.log&&this.log(a.event.name,a),a&&"object"==typeof a?!this.config.disabled&&(this.send(a),!0):(this.log("Invalid event."),!1))},send:function(a){a=this.extend(this.eventData(),a),this.fireXhr(this.config.eventApi.url,[a],this.config.eventApi.requestMethod,this.config.eventApi.headers)},getUtmSource:function(){return b.referrer?function(){var a=b.createElement("a");return a.href=b.referrer,a.hostname.replace(/^www\./i,"")}():"direct"},getUtmMedium:function(){var a=b.referrer?function(){var a=b.createElement("a");return a.href=b.referrer,a.hostname.replace(/^www\./i,"")}():null;return a?a.match(new RegExp("(google|yahoo|bing|baidu|aol|ask|excite|duckduckgo).([^/?]*)","i"))?"organic":a.match(new RegExp("(tumblr|flickr|pinterest|linkedin|youtube|twitter|facebook|instagram).([^/?]*)","i"))?"social":"":""},getUtmLanding:function(){var b="other",c=a.location.pathname||"";return"/"===c||-1!==("/"+this.config.cities.join("/")).indexOf(c)?b="homepage":-1!==c.indexOf("/request/")?b="request":-1!==c.indexOf("/pro/")?b="pro":-1!==c.indexOf("/r/")?b="sem":c.match(new RegExp("["+this.config.cities.join("|")+"-]+","i"))&&(b="listing"),b},getUtm:function(a){switch(a){case"source":var b=this.getUtmSource();return this.getQueryParam("utm_source")||("direct"===b||"urbanclap.com"===b?this.cookie.get("_uca_utm_source")||"direct":b);case"medium":return this.getQueryParam("utm_medium")||this.getUtmMedium()||this.cookie.get("_uca_utm_medium")||"";case"campaign":return this.getQueryParam("utm_campaign")||this.cookie.get("_uca_utm_campaign")||"";case"term":return this.getQueryParam("utm_term")||this.cookie.get("_uca_utm_term")||"";case"content":return this.getQueryParam("utm_content")||this.cookie.get("_uca_utm_content")||"";case"landing":return this.cookie.get("_uca_utm_landing")||this.getUtmLanding();case"sub_id":return this.getQueryParam("sub_id")||this.cookie.get("_uca_sub_id")||"";default:return""}},utmAttribution:function(){this.cookie.set("_uca_utm_source",this.getUtm("source"),this.config.attributionValidDays),this.cookie.set("_uca_utm_medium",this.getUtm("medium"),this.config.attributionValidDays),this.cookie.set("_uca_utm_campaign",this.getUtm("campaign"),this.config.attributionValidDays),this.cookie.set("_uca_utm_term",this.getUtm("term"),this.config.attributionValidDays),this.cookie.set("_uca_utm_content",this.getUtm("content"),this.config.attributionValidDays),this.cookie.set("_uca_utm_landing",this.getUtm("landing"),this.config.attributionValidDays),this.cookie.set("_uca_sub_id",this.getUtm("sub_id"),1/24)},fireSession:function(){var a=[{event_timestamp:this.getTime().toString(),client_timestamp:(+new Date).toString(),schema_type:"session",session:{session_id:this.session.get().id,start_timestamp:this.session.get().startTs.toString()},user:{user_type:this.config.userType||"",user_id:this.cookie.get("_uc_user_id")||""},client:{client_type:this.browserInfo.type(),device_id:this.store.uuid,device_os:this.defaultData.userAgent,version:this.defaultData.appVersion+"-"+this.version},install_source:{utm_source:this.cookie.get("_uca_utm_source")||"",utm_medium:this.cookie.get("_uca_utm_medium")||"",utm_campaign:this.cookie.get("_uca_utm_campaign")||"",utm_content:this.cookie.get("_uca_utm_content")||"",utm_text:this.getQueryParam("utm_text")||"",af_pid:this.cookie.get("_uca_sub_id")||this.getQueryParam("af_pid")||"",af_campaign:this.getQueryParam("af_campaign")||"",af_install_time:"",af_click_time:""}}];return this.config.log&&this.log("session",a[0]),!this.config.disabled&&(this.fireXhr(this.config.eventApi.url,a,this.config.eventApi.requestMethod,this.config.eventApi.headers),!0)},fireXhr:function(b,c,d,e,f){try{var g=a.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f&&(g.onreadystatechange=function(){4===g.readyState&&f(g)}),g.open(d,b,!0);for(var h in e)g.setRequestHeader(h,e[h]);g.send(JSON.stringify(c))}catch(a){this.log(a)}},extend:function(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]},log:function(){a.console&&a.console.log.apply(a.console,[].slice.call(arguments))}};e.serverSync(function(){a.uca=c.analytics=this.init(),c.analytics&&this.fireQueuedEvents()}.bind(e))}(window,document);